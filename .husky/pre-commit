#!/bin/sh
. ~/.nvm/nvm.sh

echo "🔨 Checking build..."
npm run build

if [ $? -ne 0 ]; then
    echo "❌ Build failed! Fix errors before committing."
    exit 1
fi

echo "✅ Build successful!"
echo ""

echo "🧹 Running lint-staged..."
npx lint-staged

if [ $? -ne 0 ]; then
    echo "❌ Lint-staged failed! Fix errors before committing."
    exit 1
fi

echo "✅ Lint-staged passed!"
echo ""

echo "📊 Checking test coverage..."
npm run test:coverage:check

if [ $? -ne 0 ]; then
    echo "❌ Test coverage is insufficient! Add more tests."
    exit 1
fi

echo "✅ All checks passed! Commit allowed. 🎉"
